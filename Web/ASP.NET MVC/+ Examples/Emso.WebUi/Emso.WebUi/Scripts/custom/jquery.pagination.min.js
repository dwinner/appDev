(function(n){n.PaginationCalculator=function(n,t){this.maxentries=n;this.opts=t};n.extend(n.PaginationCalculator.prototype,{numPages:function(){return Math.ceil(this.maxentries/this.opts.items_per_page)},getInterval:function(n){var t=Math.floor(this.opts.num_display_entries/2),i=this.numPages(),r=i-this.opts.num_display_entries,u=n>t?Math.max(Math.min(n-t,r),0):0,f=n>t?Math.min(n+t+this.opts.num_display_entries%2,i):Math.min(this.opts.num_display_entries,i);return{start:u,end:f}}});n.PaginationRenderers={};n.PaginationRenderers.defaultRenderer=function(t,i){this.maxentries=t;this.opts=i;this.pc=new n.PaginationCalculator(t,i)};n.extend(n.PaginationRenderers.defaultRenderer.prototype,{createLink:function(t,i,r){var f=this.pc.numPages(),u;return t=t<0?0:t<f?t:f-1,r=n.extend({text:t+1,classes:""},r||{}),u=t===i?n("<span class='current'>"+r.text+"<\/span>"):n("<a>"+r.text+"<\/a>").attr("href",this.opts.link_to.replace(/__id__/,t)),r.classes&&u.addClass(r.classes),r.rel&&u.attr("rel",r.rel),u.data("page_id",t),u},appendRange:function(n,t,i,r,u){for(var f=i;f<r;f++)this.createLink(f,t,u).appendTo(n)},getLinks:function(t,i){var e,o,u=this.pc.getInterval(t),f=this.pc.numPages(),r=n("<div class='pagination'><\/div>");return this.opts.prev_text&&(t>0||this.opts.prev_show_always)&&r.append(this.createLink(t-1,t,{text:this.opts.prev_text,classes:"prev",rel:"prev"})),u.start>0&&this.opts.num_edge_entries>0&&(o=Math.min(this.opts.num_edge_entries,u.start),this.appendRange(r,t,0,o,{classes:"sp"}),this.opts.num_edge_entries<u.start&&this.opts.ellipse_text&&n("<span>"+this.opts.ellipse_text+"<\/span>").appendTo(r)),this.appendRange(r,t,u.start,u.end),u.end<f&&this.opts.num_edge_entries>0&&(f-this.opts.num_edge_entries>u.end&&this.opts.ellipse_text&&n("<span>"+this.opts.ellipse_text+"<\/span>").appendTo(r),e=Math.max(f-this.opts.num_edge_entries,u.end),this.appendRange(r,t,e,f,{classes:"ep"})),this.opts.next_text&&(t<f-1||this.opts.next_show_always)&&r.append(this.createLink(t+1,t,{text:this.opts.next_text,classes:"next",rel:"next"})),n("a",r).click(i),r}});n.fn.pagination=function(t,i){function h(t){t.preventDefault();var r=n(t.target).data("page_id"),i=u(r);return i||t.stopPropagation(),i}function u(n){r.data("current_page",n);f=s.getLinks(n,h);r.empty();f.appendTo(r);return i.callback(n,r)}var r,s,f,e,c,o;if(i=n.extend({items_per_page:10,num_display_entries:11,current_page:0,num_edge_entries:0,link_to:"#",prev_text:"&laquo;",next_text:"&raquo;",ellipse_text:"...",prev_show_always:!0,next_show_always:!0,renderer:"defaultRenderer",show_if_single_page:!1,load_first_page:!0,callback:function(){return!1}},i||{}),r=this,e=parseInt(i.current_page,10),r.data("current_page",e),t=!t||t<0?1:t,i.items_per_page=!i.items_per_page||i.items_per_page<0?1:i.items_per_page,!n.PaginationRenderers[i.renderer])throw new ReferenceError("Pagination renderer '"+i.renderer+"' was not found in jQuery.PaginationRenderers object.");s=new n.PaginationRenderers[i.renderer](t,i);c=new n.PaginationCalculator(t,i);o=c.numPages();r.off("setPage").on("setPage",{numPages:o},function(n,t){return t>=0&&t<n.data.numPages?(u(t),!1):!0});r.off("prevPage").on("prevPage",function(){var t=n(this).data("current_page");return t>0&&u(t-1),!1});r.off("nextPage").on("nextPage",{numPages:o},function(t){var i=n(this).data("current_page");return i<t.data.numPages-1&&u(i+1),!1});r.off("currentPage").on("currentPage",function(){var t=n(this).data("current_page");return u(t),!1});f=s.getLinks(e,h);r.empty();(o>1||i.show_if_single_page)&&f.appendTo(r);i.load_first_page&&i.callback(e,r)}})(jQuery);